---
const allPages = [
	{ text: "About Us", url: "/en/company" },
	{ text: "Careers", url: "/en/careers" },
	{ text: "Terms and Conditions", url: "/en/terms" },
	{ text: "Privacy Policy", url: "/en/privacy" },
	{ text: "Imprint", url: "/en/imprint" },
];
---

<header
	class="fixed w-full bg-white/90 dark:bg-secondary-950/90 backdrop-blur-xs z-50 py-4 transition-colors duration-300"
>
	<div class="container-custom flex items-center justify-between">
		<a href="/en/" class="flex items-center" aria-label="Go to homepage">
			<img src="/favicon.svg" alt="KMF Logo" class="h-10 w-auto" />
			<span
				class="ml-2 text-xl font-display font-semibold text-secondary-900 dark:text-white"
				>KMF Products</span
			>
		</a>

		<nav class="hidden md:flex items-center space-x-8">
			<a
				href="/en/"
				class="text-secondary-600 hover:text-primary-600 dark:text-secondary-300 dark:hover:text-primary-400 font-medium transition-colors"
				>Home</a
			>
			<a
				href="/en/faqs"
				class="text-secondary-600 hover:text-primary-600 dark:text-secondary-300 dark:hover:text-primary-400 font-medium transition-colors"
				>FAQ</a
			>
			<a
				href="/en/pricing"
				class="text-secondary-600 hover:text-primary-600 dark:text-secondary-300 dark:hover:text-primary-400 font-medium transition-colors"
				>Pricing</a
			>
			<a
				href="/en/contact"
				class="text-secondary-600 hover:text-primary-600 dark:text-secondary-300 dark:hover:text-primary-400 font-medium transition-colors"
				>Contact</a
			>

			<!-- All Pages Dropdown -->
			<div x-data="{ open: false }" class="relative">
				<button
					@click="open = !open"
					@click.away="open = false"
					class="flex items-center text-secondary-600 hover:text-primary-600 dark:text-secondary-300 dark:hover:text-primary-400 font-medium transition-colors"
				>
					All Pages
					<svg
						xmlns="http://www.w3.org/2000/svg"
						class="h-4 w-4 ml-1"
						fill="none"
						viewBox="0 0 24 24"
						stroke="currentColor"
					>
						<path
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="2"
							d="M19 9l-7 7-7-7"></path>
					</svg>
				</button>

				<div
					x-show="open"
					x-transition:enter="transition ease-out duration-200"
					x-transition:enter-start="opacity-0 scale-95"
					x-transition:enter-end="opacity-100 scale-100"
					x-transition:leave="transition ease-in duration-150"
					x-transition:leave-start="opacity-100 scale-100"
					x-transition:leave-end="opacity-0 scale-95"
					class="absolute left-0 mt-2 w-56 bg-white dark:bg-secondary-900 rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-hidden z-50 max-h-96 overflow-y-auto"
					x-cloak
				>
					<div class="py-2 grid grid-cols-1 gap-1">
						{
							allPages.map((page) => (
								<a
									href={page.url}
									class="block px-4 py-2 text-sm text-secondary-700 dark:text-secondary-300 hover:bg-secondary-100 dark:hover:bg-secondary-800"
								>
									{page.text}
								</a>
							))
						}
					</div>
				</div>
			</div>
		</nav>

		<div class="flex items-center space-x-4">
			<div x-data="{ open: false }" class="relative">
				<button
					@click="open = !open"
					@click.away="open = false"
					class="p-2 rounded-full text-secondary-500 hover:text-secondary-700 dark:text-secondary-400 dark:hover:text-secondary-200 focus:outline-hidden focus:ring-2 focus:ring-primary-500"
					aria-label="Language switcher"
				>
					<svg
						xmlns="http://www.w3.org/2000/svg"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
						class="icon icon-tabler icons-tabler-outline icon-tabler-language-hiragana h-6 w-6 align-middle transform translate-y-[3px]"
					>
						<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
						<path d="M4 5h7"></path>
						<path d="M7 4c0 4.846 0 7 .5 8"></path>
						<path
							d="M10 8.5c0 2.286 -2 4.5 -3.5 4.5s-2.5 -1.135 -2.5 -2c0 -2 1 -3 3 -3s5 .57 5 2.857c0 1.524 -.667 2.571 -2 3.143"
						></path>
						<path d="M12 20l4 -9l4 9"></path>
						<path d="M19.1 18h-6.2"></path>
					</svg>
				</button>

				<div
					x-data="{ current: window.location.pathname }"
					x-show="open"
					x-transition
					x-cloak
					class="absolute right-7/16 -translate-x-1/2 mt-2 bg-white dark:bg-secondary-900 shadow-lg rounded-md ring-1 ring-black ring-opacity-5 z-50 px-2 py-2"
				>
					<div class="flex flex-col items-center text-center w-max">
						<a
							href="/en/"
							:class="current.startsWith('/en') 
              ? 'ring-2 ring-primary-500 dark:ring-primary-400 bg-secondary-100 dark:bg-secondary-800 text-black dark:text-white' 
              : 'text-secondary-700 dark:text-secondary-300 hover:bg-secondary-100 dark:hover:bg-secondary-800'"
							class="text-sm px-4 py-2 rounded w-full"
						>
							English
						</a>
						<div
							class="border-t border-secondary-200 dark:border-secondary-700 w-full my-1"
						>
						</div>
						<a
							href="/"
							:class="current === '/' 
              ? 'ring-2 ring-primary-500 dark:ring-primary-400 bg-secondary-100 dark:bg-secondary-800 text-black dark:text-white' 
              : 'text-secondary-700 dark:text-secondary-300 hover:bg-secondary-100 dark:hover:bg-secondary-800'"
							class="text-sm px-4 py-2 rounded w-full"
						>
							German
						</a>
					</div>
				</div>
				<button
					x-on:click="darkMode = !darkMode"
					class="p-2 rounded-full text-secondary-500 hover:text-secondary-700 dark:text-secondary-400 dark:hover:text-secondary-200 focus:outline-hidden focus:ring-2 focus:ring-primary-500"
					aria-label="Toggle dark mode"
				>
					<svg
						x-show="!darkMode"
						xmlns="http://www.w3.org/2000/svg"
						class="h-5 w-5"
						fill="none"
						viewBox="0 0 24 24"
						stroke="currentColor"
					>
						<path
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="2"
							d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
						></path>
					</svg>
					<svg
						x-show="darkMode"
						xmlns="http://www.w3.org/2000/svg"
						class="h-5 w-5"
						fill="none"
						viewBox="0 0 24 24"
						stroke="currentColor"
					>
						<path
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="2"
							d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
						></path>
					</svg>
				</button>

				<a
					href="#signup"
					class="hidden sm:inline-flex btn-primary transform translate-y-[-4px]"
					>Get Started</a
				>

				<!-- Mobile Menu Button and Dropdown -->
				<div x-data="{ open: false, showAllPages: false }">
					<button
						@click="open = !open"
						class="md:hidden p-2 rounded-md text-secondary-600 hover:text-secondary-900 dark:text-secondary-300 dark:hover:text-white focus:outline-hidden focus:ring-2 focus:ring-primary-500"
						aria-label="Toggle menu"
					>
						<svg
							x-show="!open"
							xmlns="http://www.w3.org/2000/svg"
							class="h-6 w-6"
							fill="none"
							viewBox="0 0 24 24"
							stroke="currentColor"
						>
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								stroke-width="2"
								d="M4 6h16M4 12h16M4 18h16"></path>
						</svg>
						<svg
							x-show="open"
							xmlns="http://www.w3.org/2000/svg"
							class="h-6 w-6"
							fill="none"
							viewBox="0 0 24 24"
							stroke="currentColor"
						>
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								stroke-width="2"
								d="M6 18L18 6M6 6l12 12"></path>
						</svg>
					</button>

					<div
						x-show="open"
						x-transition:enter="transition ease-out duration-200"
						x-transition:enter-start="opacity-0 scale-95"
						x-transition:enter-end="opacity-100 scale-100"
						x-transition:leave="transition ease-in duration-150"
						x-transition:leave-start="opacity-100 scale-100"
						x-transition:leave-end="opacity-0 scale-95"
						class="absolute top-16 right-4 w-48 py-2 bg-white dark:bg-secondary-900 rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-hidden"
						x-cloak
					>
						<a
							href="/en/features"
							class="block px-4 py-2 text-sm text-secondary-700 dark:text-secondary-300 hover:bg-secondary-100 dark:hover:bg-secondary-800"
							>Features</a
						>
						<a
							href="/en/pricing"
							class="block px-4 py-2 text-sm text-secondary-700 dark:text-secondary-300 hover:bg-secondary-100 dark:hover:bg-secondary-800"
							>Pricing</a
						>
						<a
							href="/en/blog"
							class="block px-4 py-2 text-sm text-secondary-700 dark:text-secondary-300 hover:bg-secondary-100 dark:hover:bg-secondary-800"
							>Blog</a
						>
						<a
							href="/en/contact"
							class="block px-4 py-2 text-sm text-secondary-700 dark:text-secondary-300 hover:bg-secondary-100 dark:hover:bg-secondary-800"
							>Contact</a
						>

						<!-- Mobile All Pages Dropdown -->
						<button
							@click="showAllPages = !showAllPages"
							class="w-full text-left px-4 py-2 text-sm text-secondary-700 dark:text-secondary-300 hover:bg-secondary-100 dark:hover:bg-secondary-800 font-semibold border-t border-gray-200 dark:border-gray-700 mt-1 pt-1 flex items-center justify-between"
						>
							All Pages
							<svg
								xmlns="http://www.w3.org/2000/svg"
								class="h-4 w-4"
								fill="none"
								viewBox="0 0 24 24"
								stroke="currentColor"
							>
								<path
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="2"
									d="M19 9l-7 7-7-7"></path>
							</svg>
						</button>

						<div x-show="showAllPages" class="space-y-1 mt-2">
							{
								allPages.map((page) => (
									<a
										href={page.url}
										class="block px-4 py-2 text-sm text-secondary-700 dark:text-secondary-300 hover:bg-secondary-100 dark:hover:bg-secondary-800"
									>
										{page.text}
									</a>
								))
							}
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<style>
		/* Add styles for dark mode SVG in the header */
		@media (prefers-color-scheme: dark) {
			.dark\:fill-slate-800 {
				fill: #1e293b;
			}
			.dark\:fill-slate-600 {
				fill: #475569;
			}
			.dark\:fill-slate-500 {
				fill: #64748b;
			}
			.dark\:fill-slate-700 {
				fill: #334155;
			}
			.dark\:stroke-slate-300 {
				stroke: #cbd5e1;
			}
			.dark\:stroke-teal-500 {
				stroke: #14b8a6;
			}
			.dark\:fill-white {
				fill: #ffffff;
			}
		}

		/* Add hover animation to the logo */
		header a:hover svg {
			transform: scale(1.05);
			transition: transform 0.3s ease;
		}

		/* Hide Alpine.js elements before Alpine loads */
		[x-cloak] {
			display: none !important;
		}
	</style>
</header>
